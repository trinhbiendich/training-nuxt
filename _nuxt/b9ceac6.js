(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{279:function(t,e,r){var n=r(5),o=r(208).values;n({target:"Object",stat:!0},{values:function(t){return o(t)}})},285:function(t,e,r){var content=r(302);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(67).default)("223ce4d7",content,!0,{sourceMap:!1})},286:function(t,e,r){var content=r(304);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(67).default)("a7fee0d6",content,!0,{sourceMap:!1})},289:function(t,e,r){"use strict";r.r(e);r(7);var n={props:{images:Array,user:Object},methods:{getThumbnails:function(){return void 0===this.user.thumbnails?[]:this.user.thumbnails},chooseAsAvatar:function(image){this.user.avatar=this.urlMax(image),this.$axios.$post("/users/".concat(this.user.user_id),this.user).then((function(t){console.log(t)})),this.$axios.$post("/users_done/".concat(this.user.user_id),this.user).then((function(t){console.log(t)}))},addToThumbnail:function(image){void 0===this.user.thumbnails&&(this.user.thumbnails=[]),this.user.thumbnails.push(this.urlMax(image)),this.$axios.$post("/users/".concat(this.user.user_id),this.user).then((function(t){console.log(t)})),this.$axios.$post("/users_done/".concat(this.user.user_id),this.user).then((function(t){console.log(t)}))},urlMin:function(img){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=["sq","q","t","s","n","w","m","z","c","l","h","o"],i=0;i<e.length;i++){var r=e[i];if(void 0!==img["url_".concat(r)]&&(!(null!==t&&img["width_".concat(r)]<t)&&void 0!==img["url_".concat(r)]))return img["url_".concat(r)]}return"/images/no-image.png"},urlMax:function(img){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=["sq","q","t","s","n","w","m","z","c","l","h","k","3k","4k","5k","6k","o"].reverse(),i=0;i<e.length;i++){var r=e[i];if(void 0!==img["url_".concat(r)]&&(!(null!==t&&img["width_".concat(r)]>t)&&void 0!==img["url_".concat(r)]))return img["url_".concat(r)]}return"/images/no-image.png"},getVideoLink:function(img,t){return t?"https://www.flickr.com/video_download.gne?id=".concat(img.id):"https://www.flickr.com/photos/".concat(this.user.user_id,"/").concat(img.id,"/in/datetaken/")}}},o=(r(301),r(49)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"myGallery",attrs:{id:"myGallery"}},t._l(t.images,(function(img,e){return r("div",{key:"img_"+e,staticClass:"img-item"},[r("div",{staticClass:"control"},["video"===img.media?[r("a",{staticClass:"btn btn-primary",attrs:{target:"_blank",href:t.getVideoLink(img,!1)}},[r("i",{staticClass:"fa fa-link",attrs:{"aria-hidden":"true"}})]),t._v(" "),r("a",{staticClass:"btn btn-primary",attrs:{target:"_blank",href:t.getVideoLink(img,!0)}},[r("i",{staticClass:"fa fa-video-camera",attrs:{"aria-hidden":"true"}})])]:[r("a",{staticClass:"btn btn-info",attrs:{target:"_blank",href:t.urlMax(img)}},[r("i",{staticClass:"fa fa-eye"})]),t._v(" "),t.getThumbnails().indexOf(t.urlMax(img))<0?r("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",title:"Add to thumbnail"},on:{click:function(e){return t.addToThumbnail(img)}}},[r("i",{staticClass:"fa fa-plus"})]):t._e(),t._v(" "),t.user.avatar!==t.urlMax(img)?r("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",title:"Choose as Avatar"},on:{click:function(e){return t.chooseAsAvatar(img)}}},[r("i",{staticClass:"fa fa-check-circle-o",attrs:{"aria-hidden":"true"}})]):t._e()]],2),t._v(" "),r("img",{staticClass:"img-fluid lazy",attrs:{src:t.urlMin(img,300)}})])})),0)}),[],!1,null,"02f3d5e0",null);e.default=component.exports},301:function(t,e,r){"use strict";r(285)},302:function(t,e,r){(e=r(66)(!1)).push([t.i,".control[data-v-02f3d5e0]{position:relative;z-index:10}",""]),t.exports=e},303:function(t,e,r){"use strict";r(286)},304:function(t,e,r){(e=r(66)(!1)).push([t.i,".center[data-v-328ada72]{text-align:center}.center-screen[data-v-328ada72]{position:fixed;top:45%;left:45%}.loading[data-v-328ada72]{border:16px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin-data-v-328ada72 2s linear infinite;animation:spin-data-v-328ada72 2s linear infinite}@-webkit-keyframes spin-data-v-328ada72{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spin-data-v-328ada72{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""]),t.exports=e},312:function(t,e,r){"use strict";r.r(e);r(7),r(11),r(14),r(85),r(279),r(6),r(13),r(12);var n=r(39),o={components:{Galleries:r(289).default},head:function(){return{title:""===this.pageInfo.title?"NuxtJS":this.pageInfo.title}},data:function(){return{pageInfo:{title:"Detail page"},user:{},imgs:[],photoIds:[],msg:"",userId:"",curPage:1,perPage:50,totalPage:1,curTotalImages:0,isLoading:!1,pages:[],focusPage:""}},mounted:function(){var t=this;this.userId=this.$route.query.userId;var e="";void 0!==this.$route.query.page&&""!==this.$route.query.page&&(e=this.$route.query.page),this.pageInfo.title="Detail of "+this.userId,this.loadUserInfo(),this.loadPages((function(){""===e&&(e=t.pages[0]),t.loadImageForPage(e)}))},methods:{loadImageForPage:function(t){var e=this;t!==this.focusPage&&(this.$router.replace({query:{userId:this.userId,page:t}}),this.isLoading=!0,this.photoIds=[],this.curPage=1,this.totalPage=1,this.imgs=[],this.curTotalImages=0,this.focusPage=t,this.$axios.$get("/".concat(this.userId).concat(t)).then((function(t){if("success"===t.type){e.photoIds=t.data;var r=0;"object"===Object(n.a)(e.photoIds)?(r=Object.keys(e.photoIds).length,e.photoIds=Object.values(e.photoIds)):r=e.photoIds.length,e.totalPage=Math.ceil(r/e.perPage),e.loadImagesFromServer()}})))},loadUserInfo:function(){var t=this;this.$axios.$get("/users/".concat(this.userId)).then((function(e){if("success"===e.type){t.user=e.data;var r=""!==t.user.realname?t.user.realname:t.user.username;t.pageInfo.title="[".concat(t.userId,"] - ").concat(r)}else t.msg="There are no images or data on this user"}))},loadPages:function(t){var e=this;this.$axios.$get("/".concat(this.userId,"_pageInfo")).then((function(r){"success"===r.type?(e.pages=r.data,t()):e.msg="There are no images or data on this user"}))},loadImagesFromServer:function(){var t=this;if(!(this.curPage>this.totalPage)){var e=0,r=(this.curPage-1)*this.perPage,n=r+this.perPage;this.isLoading=!0;var o=this.photoIds.slice(r,n);this.curPage++,this.curTotalImages+=o.length,o.forEach((function(r,n){t.$axios.$get("/photos_".concat(r)).then((function(r){e++,t.addImage(r),e>=o.length&&(t.isLoading=!1,t.$nextTick((function(){$("#myGallery").justifiedGallery({rowHeight:300,lastRow:"nojustify",margins:3})})))}))}))}},addImage:function(t){"success"===t.type&&this.imgs.push(t.data)}}},c=(r(303),r(49)),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 p-3"},[r("router-link",{staticClass:"btn btn-success",attrs:{to:"/flickr"}},[r("i",{staticClass:"fa fa-reply"}),t._v(" Go back")]),t._v(" "),t._m(0)],1),t._v(" "),r("div",{staticClass:"col-12 p-3"},t._l(t.pages,(function(e){return r("a",{key:e,staticClass:"badge mr-2",class:{"badge-success":e===t.focusPage,"badge-info":e!==t.focusPage},attrs:{href:"javascript:;"},on:{click:function(r){return t.loadImageForPage(e)}}},[t._v(t._s(e))])})),0)]),t._v(" "),""!==t.msg?r("div",[r("div",{staticClass:"alert alert-info"},[t._v(t._s(t.msg))])]):t._e(),t._v(" "),r("Galleries",{attrs:{user:t.user,images:t.imgs}}),t._v(" "),t.isLoading?r("div",{ref:"loading",staticClass:"loading center-screen"}):t._e(),t._v(" "),r("div",{staticClass:"center"},[t.curPage<=t.totalPage?r("a",{staticClass:"btn btn-success",on:{click:t.loadImagesFromServer}},[t._v("Load more")]):t._e()])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn btn-primary",attrs:{href:"javascript:;"}},[e("i",{staticClass:"fa fa-download"}),this._v(" Download")])}],!1,null,"328ada72",null);e.default=component.exports;installComponents(component,{Galleries:r(289).default})}}]);