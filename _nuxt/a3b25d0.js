(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{274:function(t,e,n){var o=n(5),r=n(205).values;o({target:"Object",stat:!0},{values:function(t){return r(t)}})},280:function(t,e,n){var content=n(297);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(66).default)("20e9a4d0",content,!0,{sourceMap:!1})},281:function(t,e,n){var content=n(299);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(66).default)("173eba50",content,!0,{sourceMap:!1})},284:function(t,e,n){"use strict";n.r(e);n(7);var o={props:{images:Array,user:Object},methods:{getThumbnails:function(){return void 0===this.user.thumbnails?[]:this.user.thumbnails},chooseAsAvatar:function(image){this.user.avatar=this.urlMax(image),this.$axios.$post("/users/".concat(this.user.user_id),this.user).then((function(t){console.log(t)})),this.$axios.$post("/users_done/".concat(this.user.user_id),this.user).then((function(t){console.log(t)}))},addToThumbnail:function(image){void 0===this.user.thumbnails&&(this.user.thumbnails=[]),this.user.thumbnails.push(this.urlMax(image)),this.$axios.$post("/users/".concat(this.user.user_id),this.user).then((function(t){console.log(t)})),this.$axios.$post("/users_done/".concat(this.user.user_id),this.user).then((function(t){console.log(t)}))},urlMin:function(img){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=["sq","q","t","s","n","w","m","z","c","l","h","o"],i=0;i<e.length;i++){var n=e[i];if(void 0!==img["url_".concat(n)]&&(!(null!==t&&img["width_".concat(n)]<t)&&void 0!==img["url_".concat(n)]))return img["url_".concat(n)]}return"/images/no-image.png"},urlMax:function(img){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=["sq","q","t","s","n","w","m","z","c","l","h","k","3k","4k","5k","6k","o"].reverse();if("video"===img.media)return"https://www.flickr.com/photos/".concat(this.userId,"/").concat(img.id,"/in/datetaken/");for(var i=0;i<e.length;i++){var n=e[i];if(void 0!==img["url_".concat(n)]&&(!(null!==t&&img["width_".concat(n)]>t)&&void 0!==img["url_".concat(n)]))return img["url_".concat(n)]}return"/images/no-image.png"}}},r=(n(296),n(49)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"myGallery",attrs:{id:"myGallery"}},t._l(t.images,(function(img,e){return n("div",{key:"img_"+e,staticClass:"img-item"},[n("div",{staticClass:"control"},[n("a",{staticClass:"btn btn-info",attrs:{target:"_blank",href:t.urlMax(img)}},[n("i",{staticClass:"fa fa-eye"})]),t._v(" "),t.getThumbnails().indexOf(t.urlMax(img))<0?n("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",title:"Add to thumbnail"},on:{click:function(e){return t.addToThumbnail(img)}}},[n("i",{staticClass:"fa fa-plus"})]):t._e(),t._v(" "),t.user.avatar!==t.urlMax(img)?n("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",title:"Choose as Avatar"},on:{click:function(e){return t.chooseAsAvatar(img)}}},[n("i",{staticClass:"fa fa-check-circle-o",attrs:{"aria-hidden":"true"}})]):t._e()]),t._v(" "),n("img",{staticClass:"img-fluid lazy",attrs:{src:t.urlMin(img,300)}})])})),0)}),[],!1,null,"2c3ec87c",null);e.default=component.exports},296:function(t,e,n){"use strict";n(280)},297:function(t,e,n){(e=n(65)(!1)).push([t.i,".control[data-v-2c3ec87c]{position:relative;z-index:10}",""]),t.exports=e},298:function(t,e,n){"use strict";n(281)},299:function(t,e,n){(e=n(65)(!1)).push([t.i,".center[data-v-05777052]{text-align:center}.center-screen[data-v-05777052]{position:fixed;top:45%;left:45%}.loading[data-v-05777052]{border:16px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:120px;height:120px;-webkit-animation:spin-data-v-05777052 2s linear infinite;animation:spin-data-v-05777052 2s linear infinite}@-webkit-keyframes spin-data-v-05777052{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spin-data-v-05777052{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",""]),t.exports=e},306:function(t,e,n){"use strict";n.r(e);n(7),n(11),n(14),n(85),n(274),n(12);var o=n(42),r={components:{Galleries:n(284).default},head:function(){return{title:""===this.pageInfo.title?"NuxtJS":this.pageInfo.title}},data:function(){return{pageInfo:{title:"Detail page"},user:{},imgs:[],photoIds:[],msg:"",userId:"",curPage:1,perPage:50,totalPage:1,curTotalImages:0,isLoading:!1,pages:[],focusPage:""}},mounted:function(){var t=this;this.userId=this.$route.query.userId,this.pageInfo.title="Detail of "+this.userId,this.loadUserInfo(),this.loadPages((function(){t.loadImageForPage(t.pages[0])}))},methods:{loadImageForPage:function(t){var e=this;t!==this.focusPage&&(this.isLoading=!0,this.photoIds=[],this.curPage=1,this.totalPage=1,this.imgs=[],this.curTotalImages=0,this.focusPage=t,this.$axios.$get("/".concat(this.userId).concat(t)).then((function(t){if("success"===t.type){e.photoIds=t.data;var n=0;"object"===Object(o.a)(e.photoIds)?(n=Object.keys(e.photoIds).length,e.photoIds=Object.values(e.photoIds)):n=e.photoIds.length,e.totalPage=Math.ceil(n/e.perPage),e.loadImagesFromServer()}})))},loadUserInfo:function(){var t=this;this.$axios.$get("/users/".concat(this.userId)).then((function(e){if("success"===e.type){t.user=e.data;var n=""!==t.user.realname?t.user.realname:t.user.username;t.pageInfo.title="[".concat(t.userId,"] - ").concat(n)}else t.msg="There are no images or data on this user"}))},loadPages:function(t){var e=this;this.$axios.$get("/".concat(this.userId,"_pageInfo")).then((function(n){"success"===n.type?(e.pages=n.data,t()):e.msg="There are no images or data on this user"}))},loadImagesFromServer:function(){var t=this;if(!(this.curPage>this.totalPage)){var e=0,n=(this.curPage-1)*this.perPage,o=n+this.perPage;this.isLoading=!0;var r=this.photoIds.slice(n,o);this.curPage++,this.curTotalImages+=r.length,r.forEach((function(n,o){t.$axios.$get("/".concat(t.userId).concat(t.focusPage,"_").concat(n)).then((function(n){e++,t.addImage(n),e>=r.length&&(t.isLoading=!1,t.$nextTick((function(){$("#myGallery").justifiedGallery({rowHeight:300,lastRow:"nojustify",margins:3})})))}))}))}},addImage:function(t){"success"===t.type&&this.imgs.push(t.data)}}},c=(n(298),n(49)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-12 p-3"},[n("router-link",{staticClass:"btn btn-success",attrs:{to:"/flickr"}},[n("i",{staticClass:"fa fa-reply"}),t._v(" Go back")]),t._v(" "),t._m(0)],1),t._v(" "),n("div",{staticClass:"col-12 p-3"},t._l(t.pages,(function(e){return n("a",{key:e,staticClass:"badge mr-2",class:{"badge-success":e===t.focusPage,"badge-info":e!==t.focusPage},attrs:{href:"javascript:;"},on:{click:function(n){return t.loadImageForPage(e)}}},[t._v(t._s(e))])})),0)]),t._v(" "),""!==t.msg?n("div",[n("div",{staticClass:"alert alert-info"},[t._v(t._s(t.msg))])]):t._e(),t._v(" "),n("Galleries",{attrs:{user:t.user,images:t.imgs}}),t._v(" "),t.isLoading?n("div",{ref:"loading",staticClass:"loading center-screen"}):t._e(),t._v(" "),n("div",{staticClass:"center"},[t.curPage<=t.totalPage?n("a",{staticClass:"btn btn-success",on:{click:t.loadImagesFromServer}},[t._v("Load more")]):t._e()])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"btn btn-primary",attrs:{href:"javascript:;"}},[e("i",{staticClass:"fa fa-download"}),this._v(" Download")])}],!1,null,"05777052",null);e.default=component.exports;installComponents(component,{Galleries:n(284).default})}}]);